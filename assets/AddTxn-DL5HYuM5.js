import{b as H,r as s,t as K,p as J,f as Q,j as a,S as j}from"./index-CqIFau_T.js";function k(){var i;return((i=crypto==null?void 0:crypto.randomUUID)==null?void 0:i.call(crypto))??`${Date.now()}-${Math.random()}`}function W(){const i=H(),v=s.useId(),b=s.useId(),S=s.useId(),N=s.useId(),y=s.useId(),I=s.useId(),T=s.useId(),A=s.useId(),[h,L]=s.useState(K()),[t,P]=s.useState("masuk"),[f,E]=s.useState("cash"),[o,M]=s.useState("-"),[c,O]=s.useState("-"),[C,w]=s.useState(""),[d,D]=s.useState(""),[m,B]=s.useState(!1),l=J(C),z=C?Q(l):"",U=async e=>{if(e.preventDefault(),!l){await j.fire({icon:"warning",title:"Perhatian",text:"Nominal harus diisi"});return}if(t==="alokasi"){if(o===c){await j.fire({icon:"warning",title:"Perhatian",text:"Akun asal dan tujuan tidak boleh sama"});return}i.add({id:k(),tanggal:h,tipe:"keluar",nominal:l,keterangan:d.trim()?`Transfer ke ${p(c)}: ${d}`:`Transfer ke ${p(c)}`,dihapus:!1,isPlanned:m,alokasi:o}),i.add({id:k(),tanggal:h,tipe:"masuk",nominal:l,keterangan:d.trim()?`Terima dari ${p(o)}: ${d}`:`Terima dari ${p(o)}`,dihapus:!1,isPlanned:m,alokasi:c})}else i.add({id:k(),tanggal:h,tipe:t,nominal:l,keterangan:d.trim()||void 0,dihapus:!1,isPlanned:m,alokasi:f});w(""),D(""),j.fire({icon:"success",title:"Berhasil",text:t==="alokasi"?"Transfer berhasil dicatat":"Transaksi ditambahkan",timer:1500,showConfirmButton:!1})},q=e=>P(e.target.value),$=e=>w(e.target.value),p=e=>{var n;return((n=i.allocations.find(r=>r.id===e))==null?void 0:n.label)||e},G=e=>i.allocations.map(n=>{var F;const r=((F=i.byAccount(!1)[n.id])==null?void 0:F.sisa)||0,x=l>0&&r<l;return a.jsxs("option",{value:n.id,disabled:x,children:[n.label,l>0?` (Saldo: Rp${r.toLocaleString("id-ID")})`:""]},n.id)}),R=e=>{var n;return((n=i.byAccount(!1)[e])==null?void 0:n.sisa)||0};let u=1/0;t==="keluar"?u=R(f):t==="alokasi"&&(o==="-"?u=0:u=R(o));const g=l>u;return a.jsx("div",{className:"container",children:a.jsxs("form",{className:"card form-card",onSubmit:U,style:{display:"grid",gap:12},children:[a.jsxs("div",{className:"field-group",children:[a.jsxs("div",{className:"field-row-2",children:[a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:v,children:"Tanggal"}),a.jsx("input",{id:v,type:"date",value:h,max:K(),onChange:e=>L(e.target.value)})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:b,children:"Tipe"}),a.jsxs("select",{id:b,value:t,onChange:q,children:[a.jsx("option",{value:"masuk",children:"Masuk"}),a.jsx("option",{value:"keluar",children:"Keluar"}),a.jsx("option",{value:"alokasi",children:"Alokasi"})]})]})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:I,children:"Nominal"}),a.jsx("input",{id:I,inputMode:"numeric",placeholder:"Rp0",value:z,onChange:$,onBlur:$,style:g?{borderColor:"#ef4444"}:{}}),g&&a.jsxs("div",{style:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},children:["Saldo tidak mencukupi (Max: Rp",u.toLocaleString("id-ID"),")"]})]}),t==="alokasi"?a.jsxs("div",{className:"field-row-2",children:[a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:N,children:"Dari (Sumber)"}),a.jsxs("select",{id:N,value:o,onChange:e=>M(e.target.value),children:[a.jsx("option",{value:"-",hidden:!0,children:"-"}),G()]})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:y,children:"Ke (Tujuan)"}),a.jsxs("select",{id:y,value:c,onChange:e=>O(e.target.value),children:[a.jsx("option",{value:"-",hidden:!0,children:"-"}),i.allocations.map(e=>a.jsx("option",{value:e.id,children:e.label},e.id))]})]})]}):a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:S,children:"Alokasi"}),a.jsx("select",{id:S,value:f,onChange:e=>E(e.target.value),children:i.allocations.map(e=>{var x;const n=((x=i.byAccount(!1)[e.id])==null?void 0:x.sisa)||0,r=t==="keluar"&&l>0&&n<l;return a.jsxs("option",{value:e.id,disabled:r,children:[e.label,t==="keluar"&&l>0?` (Saldo: Rp${n.toLocaleString("id-ID")})`:""]},e.id)})})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:T,children:"Keterangan"}),a.jsx("textarea",{id:T,rows:3,placeholder:"Catatan (opsional)",value:d,onChange:e=>D(e.target.value)})]}),a.jsx("div",{className:"field",style:{alignItems:"center"},children:a.jsx("div",{className:"field",children:a.jsxs("label",{htmlFor:A,style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"14px"},children:[a.jsx("input",{id:A,type:"checkbox",checked:m,onChange:e=>B(e.target.checked),style:{width:16,height:16,accentColor:"#2b6ef6"}}),"Akan datang"]})})})]}),a.jsx("button",{className:"primary",type:"submit",disabled:!l||g,children:"Simpan Transaksi"})]})})}export{W as default};
